@page "/register"
@using ShareCare.Module
@inject UserService UserService
@inject NavigationManager NavigationManager

<div id="register-page">

    <div class="design-corner top-right-light"></div>
    <div class="design-corner top-right-dark"></div>

    <div class="design-corner bottom-left-light"></div>
    <div class="design-corner bottom-left-dark"></div>

  
<div class="register-container">
    <h1 class="register-title">Create Your Account</h1>
    <p class="register-subtitle">Join us and enjoy amazing features!</p>

    <div class="input-container">
        <input id="username" class="input-field" @bind="Username" placeholder="Username" />
        <input id="firstName" class="input-field" @bind="FirstName" placeholder="First name" />
        <input id="intersertion" class="input-field" @bind="Intersertion" placeholder="Prefix" />
        <input id="lastName" class="input-field" @bind="LastName" placeholder="Last name" />
        <input id="email" class="input-field" @bind="Email" type="email" placeholder="Email" />
        <input id="dateOfBirth" class="input-field" @bind="DateOfBirth" type="date" />
        <input id="password" class="input-field" @bind="Password" type="password" placeholder="Password" />
    </div>

</div>



        <button class="register-btn" @onclick="RegisterUser">Register</button>

        @if (!string.IsNullOrEmpty(Message))
        {
            <p class="message">@Message</p>
        }

        <div class="login-link">
            <p>Already have an account? <a href="/">Log in here</a></p>
        </div>
    </div>

@code {
    private string Username;
    private string FirstName;
    private string Intersertion;
    private string LastName;
    private string Email;
    private DateTime DateOfBirth;
    private string Password;
    private string Message;

    private async System.Threading.Tasks.Task RegisterUser()
    {
        var account = new Account
            {
                Username = Username,
                Password = Password
            };

        var person = new Person
            {
                FirstName = FirstName,
                Intersertion = Intersertion,
                LastName = LastName,
                Email = Email,
                DateOfBirth = DateOnly.FromDateTime(DateOfBirth)
            };

        var success = await UserService.RegisterUser(account, person);

        if (success)
        {
            Message = "Registration successful!";
            NavigationManager.NavigateTo("/");
        }
        else
        {
            Message = "Failed to register. Please try again.";
        }
    }
}